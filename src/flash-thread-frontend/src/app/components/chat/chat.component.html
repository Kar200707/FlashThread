<div class="main-div">
  @if (userInfo) {
    <div class="selected_chat_user">
      <a routerLink="/chats-menu">
        <mat-icon>
          arrow_back
        </mat-icon>
      </a>
      <div class="img_box">
        <img [src]="userInfo.avatar" alt="user img">
        <div [class]="userInfo.isOnline ? 'online' : ''"></div>
      </div>
      <div>
        <h2>{{ userInfo.name }}</h2>
        @if (!userInfo.isOnline) {
          <p>Last connection {{ userInfo.last_connection?.hours + ':' + userInfo.last_connection?.minutes }}</p>
        } @else {
          <p>
            Online
            <mat-icon>online</mat-icon>
          </p>
        }
      </div>
    </div>
  }
  @if (!isChackChatValid) {
    <div appResizeHeight [size]="innerWidth > 940 ? 86 : 75"
         [style.top]="innerWidth > 940 ? '84px' : '74px'"
         class="first_message_block">
      <h3>Send your first letter to {{ userInfo.name }}</h3>
      <div>
        <form [formGroup]="firstMessageForm" (ngSubmit)="addNewChat()">
          <input formControlName="message" type="text" placeholder="Message">
        </form>
        <button (click)="addNewChat()">
          <mat-icon>send</mat-icon>
        </button>
      </div>
    </div>
  }
  <div #messagesScrollBox appResizeHeight [size]="170" class="messages_scroll_box">
    <div *ngIf="chatMessaging != undefined">
      <div
        *ngFor="let item of chatMessaging.messages, let i = index"
        [class]="thisUser.id !== item.userId ? 'message_box_reverce' : 'message_box'">
        <div class="message">
          @if (chatMessaging.usersId.length === 2 && thisUser.id !== item.userId) {
            <img class="in-chat-user-avatar" [src]="userInfo.avatar" alt="user img">
          }
          {{ item.message }}
        </div>
      </div>
    </div>
  </div>
  <div class="message_sending_panel">
    <button [disabled]="form.invalid" class="send_button" (click)="send()">
      <mat-icon [class]="form.valid ? 'send_button_icon-anim' : ''">arrow_upward</mat-icon>
    </button>
    <form [formGroup]="form" (ngSubmit)="send()">
      <input
        matInput
        formControlName="message"
        placeholder="Send Your Message"
        name="message"
        class="message_input"
        type="text">
    </form>
  </div>
</div>
