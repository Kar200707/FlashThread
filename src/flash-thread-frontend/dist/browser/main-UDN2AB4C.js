import"./chunk-HJPUTX5O.js";import{b as Ve}from"./chunk-32H6RCGR.js";import"./chunk-O2CKBLW2.js";import{a as Oe,c as Ne,d as G,g as je,r as De}from"./chunk-CZLUCTFN.js";import{$ as m,C as be,F as Ee,Fb as Re,Gb as ne,Kb as we,Nb as re,P as Fe,S as d,Sa as te,T as X,V as Te,Wa as h,X as F,Y as T,_b as ke,aa as u,ba as C,c as E,da as $,ea as P,g as he,h as Ae,hb as z,i as ye,j as ve,k as p,l,la as I,n as _,na as ee,r as Ie,ra as L,t as Me,v as Se,va as N,vb as Pe,yb as Z}from"./chunk-Z6NNHJ2D.js";import{i as xe,j as _e,k as B,l as A,m as q,n as Ce,r as y}from"./chunk-LHQFLOAU.js";import{d as me}from"./chunk-JMZ7DUBM.js";var oe=(e,t)=>{let r=localStorage.getItem("token"),n=C(G);return r?(n.navigate(["/messenger"]),!1):!0};var U=()=>{let e=localStorage.getItem("token"),t=C(G);return e?!0:(t.navigate(["/login"]),!1)};var $e=[{path:"",redirectTo:"messenger",pathMatch:"full"},{canActivate:[U],loadComponent:()=>import("./chunk-SRVDU2H6.js").then(e=>e.MainComponent),path:"messenger",children:[{canActivate:[U],loadComponent:()=>import("./chunk-FEXGZVVW.js").then(e=>e.ChatComponent),path:"chat/:id"}]},{canActivate:[oe],loadComponent:()=>import("./chunk-PPEZDLHS.js").then(e=>e.LoginComponent),path:"login",title:"Flash Thread Login"},{canActivate:[oe],loadComponent:()=>import("./chunk-MNBUTCYR.js").then(e=>e.RegisterComponent),path:"register",title:"Flash Thread Register"},{canActivate:[U],loadComponent:()=>import("./chunk-QOL57GB2.js").then(e=>e.ProfileEditComponent),path:"profile",title:"Profile"}];var rt="firebase",ot="10.7.2";A(rt,ot,"app");var S=new Re("ANGULARFIRE2_VERSION"),Le=e=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this
context. Rather than injecting ${e} in the constructor, first ensure that ${e} is supported by calling
\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${e})\`.`;function ze(e,t,r){if(t){if(t.length===1)return t[0];let s=t.filter(i=>i.app===r);if(s.length===1)return s[0]}return r.container.getProvider(e).getImmediate({optional:!0})}var Ze=(e,t)=>{let r=t?[t]:B(),n=[];return r.forEach(o=>{o.container.getProvider(e).instances.forEach(i=>{n.includes(i)||n.push(i)})}),n};function R(){}var W=class{zone;delegate;constructor(t,r=ye){this.zone=t,this.delegate=r}now(){return this.delegate.now()}schedule(t,r,n){let o=this.zone,s=function(i){o.runGuarded(()=>{t.apply(this,[i])})};return this.delegate.schedule(s,r,n)}},ie=class{zone;task=null;constructor(t){this.zone=t}call(t,r){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",R,{},R,R)),r.pipe(Te({next:n,complete:n,error:n})).subscribe(t).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},k=(()=>{class e{ngZone;outsideAngular;insideAngular;constructor(r){this.ngZone=r,this.outsideAngular=r.runOutsideAngular(()=>new W(Zone.current)),this.insideAngular=r.run(()=>new W(Zone.current,Ae)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||e)(u(h))};static \u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function K(){let e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return e}function it(e){return K().ngZone.runOutsideAngular(()=>e())}function M(e){return K().ngZone.run(()=>e())}function st(e){return at(K())(e)}function at(e){return function(r){return r=r.lift(new ie(e.ngZone)),r.pipe(l(e.outsideAngular),p(e.insideAngular))}}var ut=(e,t)=>function(){let n=arguments;return t&&setTimeout(()=>{t.state==="scheduled"&&t.invoke()},10),M(()=>e.apply(void 0,n))},H=(e,t)=>function(){let r,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(t&&(r||=M(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",R,{},R,R))),n[s]=ut(n[s],r));let o=it(()=>e.apply(this,n));if(!t)if(o instanceof E){let s=K();return o.pipe(l(s.outsideAngular),p(s.insideAngular))}else return M(()=>o);return o instanceof E?o.pipe(st):o instanceof Promise?M(()=>new Promise((s,i)=>o.then(a=>M(()=>s(a)),a=>M(()=>i(a))))):typeof o=="function"&&r?function(){return setTimeout(()=>{r&&r.state==="scheduled"&&r.invoke()},10),o.apply(this,arguments)}:M(()=>o)};var b=class{constructor(t){return t}},j=class{constructor(){return B()}};function pt(e){return e&&e.length===1?e[0]:new b(_e())}var se=new m("angularfire2._apps"),lt={provide:b,useFactory:pt,deps:[[new I,se]]},ft={provide:j,deps:[[new I,se]]};function gt(e){return(t,r)=>{let n=t.runOutsideAngular(()=>e(r));return new b(n)}}var dt=(()=>{class e{constructor(r){A("angularfire",S.full,"core"),A("angularfire",S.full,"app"),A("angular",ne.full,r.toString())}static \u0275fac=function(n){return new(n||e)(u(N))};static \u0275mod=P({type:e});static \u0275inj=T({providers:[lt,ft]})}return e})();function Ge(e,...t){return{ngModule:dt,providers:[{provide:se,useFactory:gt(e),multi:!0,deps:[h,L,k,...t]}]}}var Be=H(xe,!0);var D=class{constructor(t){return t}},qe="messaging",ae=class{constructor(){return Ze(qe)}};var Ue="__angularfire_symbol__messagingIsSupported",ue="__angularfire_symbol__messagingIsSupportedValue";globalThis[Ue]||=q().then(e=>globalThis[ue]=e).catch(()=>globalThis[ue]=!1);var J={async:()=>globalThis[Ue],sync:()=>{let e=globalThis[ue];if(e===void 0)throw new Error(Le("Messaging"));return e}},ce=new m("angularfire2.messaging-instances");function mt(e,t){if(!J.sync())return null;let r=ze(qe,e,t);return r&&new D(r)}function ht(e){return(t,r)=>{if(!J.sync())return null;let n=t.runOutsideAngular(()=>e(r));return new D(n)}}var At={provide:ae,deps:[[new I,ce]]},yt={provide:D,useFactory:mt,deps:[[new I,ce],b]},pe=(()=>{class e{constructor(){A("angularfire",S.full,"fcm")}static \u0275fac=function(n){return new(n||e)};static \u0275mod=P({type:e});static \u0275inj=T({providers:[yt,At,{provide:we,useValue:J.async,multi:!0}]})}return e})();function le(e,...t){return{ngModule:pe,providers:[{provide:ce,useFactory:ht(e),multi:!0,deps:[h,L,k,j,...t]}]}}var dn=J.async;var fe=H(Ce,!0);var vt="firebase",It="10.7.2";y.registerVersion(vt,It,"app-compat");var Mt=["ngOnDestroy"],Ke=(e,t,r,n={})=>new Proxy(e,{get:(o,s)=>r.runOutsideAngular(()=>{if(e[s])return n?.spy?.get&&n.spy.get(s,e[s]),e[s];if(Mt.indexOf(s)>-1)return()=>{};let i=t.toPromise().then(a=>{let f=a?.[s];return typeof f=="function"?f.bind(a):f?.then?f.then(v=>r.run(()=>v)):r.run(()=>f)});return new Proxy(()=>{},{get:(a,f)=>i[f],apply:(a,f,v)=>i.then(g=>{let x=g?.(...v);return n?.spy?.apply&&n.spy.apply(s,v,x),x})})})});var ge=class{constructor(t){return t}},Y=new m("angularfire2.app.options"),He=new m("angularfire2.app.name");function Je(e,t,r){let n=typeof r=="string"&&r||"[DEFAULT]",o=typeof r=="object"&&r||{};o.name=o.name||n;let i=y.apps.filter(a=>a&&a.name===o.name)[0]||t.runOutsideAngular(()=>y.initializeApp(e,o));try{if(JSON.stringify(e)!==JSON.stringify(i.options)){let a=!!module.hot;St("error",`${i.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new ge(i)}var St=(e,...t)=>{re()&&typeof console<"u"&&console[e](...t)};function Ye(e,t,r,n,o){let[,s,i]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===e)||[];if(s)return bt(o,i)||(We("error",`${t} was already initialized on the ${r} Firebase App with different settings.${Et?" You may need to reload as Firebase is not HMR aware.":""}`),We("warn",{is:o,was:i})),s;{let a=n();return globalThis.\u0275AngularfireInstanceCache.push([e,a,o]),a}}function bt(e,t){try{return e.toString()===t.toString()}catch{return e===t}}var Et=typeof module<"u"&&!!module.hot,We=(e,...t)=>{re()&&typeof console<"u"&&console[e](...t)};globalThis.\u0275AngularfireInstanceCache||=[];var de={apiKey:"AIzaSyBz0EakdSKMLL49mEpz6AmPpmT2pZt4JDA",authDomain:"flash-thread.firebaseapp.com",projectId:"flash-thread",storageBucket:"flash-thread.appspot.com",messagingSenderId:"889572240321",appId:"1:889572240321:web:ed23f59d691d51423fdd40",measurementId:"G-ZRLRP66075"};var Qe={providers:[{provide:Y,useValue:de},je($e),De(),ee(Ge(()=>Be(de),le(()=>fe()))),ee(le(()=>fe()))]};var Xe=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=$({type:t,selectors:[["app-layout"]],standalone:!0,features:[Z],decls:1,vars:0,template:function(o,s){o&1&&z(0,"router-outlet")},dependencies:[Ne]});let e=t;return e})();var Ft=new m("angularfire2.messaging.vapid-key"),Tt=new m("angularfire2.messaging.service-worker-registeration"),V=(()=>{class e{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(r,n,o,s,i,a,f){let v=f,g=_(void 0).pipe(l(i.outsideAngular),p(i.insideAngular),d(q),d(c=>c?import("./chunk-KYMIMPSQ.js"):ve),Ie(()=>Je(r,s,n)),d(c=>Ye(`${c.name}.messaging`,"AngularFireMessaging",c.name,()=>_(c.messaging()),[])),Fe({bufferSize:1,refCount:!1}));this.requestPermission=g.pipe(l(i.outsideAngular),p(i.insideAngular),d(()=>Notification.requestPermission())),this.getToken=g.pipe(l(i.outsideAngular),p(i.insideAngular),d(c=>me(this,null,function*(){if(Notification.permission==="granted"){let O=v?yield v:null;return yield c.getToken({vapidKey:a,serviceWorkerRegistration:O})}else return null})));let x=new E(c=>{navigator.permissions.query({name:"notifications"}).then(O=>{O.onchange=()=>c.next()})}),nt=g.pipe(l(i.outsideAngular),p(i.insideAngular),X(x),X(this.getToken));return this.tokenChanges=g.pipe(l(i.outsideAngular),p(i.insideAngular),d(()=>Se(this.getToken,nt))),this.messages=g.pipe(l(i.outsideAngular),p(i.insideAngular),d(c=>new E(O=>c.onMessage(O)))),this.requestToken=g.pipe(l(i.outsideAngular),p(i.insideAngular),d(()=>this.requestPermission),be(()=>_(null)),Me(()=>this.tokenChanges)),this.deleteToken=()=>g.pipe(l(i.outsideAngular),p(i.insideAngular),d(c=>c.deleteToken()),Ee(!1)),Ke(this,g,s)}static \u0275fac=function(n){return new(n||e)(u(Y),u(He,8),u(N),u(h),u(k),u(Ft,8),u(Tt,8))};static \u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"any"})}return e})(),et=(()=>{class e{constructor(){y.registerVersion("angularfire",S.full,"fcm-compat")}static \u0275fac=function(n){return new(n||e)};static \u0275mod=P({type:e});static \u0275inj=T({providers:[V]})}return e})();var Q=(()=>{let t=class t{constructor(n){this.angularFireMessaging=n,this.currentMessage=new he(null),this.angularFireMessaging.messages.subscribe(o=>{o.onMessage=o.onMessage.bind(o),o.onTokenRefresh=o.onTokenRefresh.bind(o)})}requestPermission(){this.angularFireMessaging.requestToken.subscribe(n=>{console.log(n)},n=>{console.error("Unable to get permission to notify. ",n)})}receiveMessage(){this.angularFireMessaging.messages.subscribe(n=>{console.log("new message received. ",n),this.currentMessage.next(n)})}};t.\u0275fac=function(o){return new(o||t)(u(V))},t.\u0275prov=F({token:t,factory:t.\u0275fac});let e=t;return e})();var tt=(()=>{let t=class t{constructor(n,o){this.messagingService=n,this.webSocket=o}ngOnInit(){this.messagingService.requestPermission()}};t.\u0275fac=function(o){return new(o||t)(te(Q),te(Ve))},t.\u0275cmp=$({type:t,selectors:[["app-root"]],standalone:!0,features:[Pe([Q,V]),Z],decls:1,vars:0,template:function(o,s){o&1&&z(0,"app-layout")},dependencies:[ke,Xe,et,pe]});let e=t;return e})();Oe(tt,Qe).catch(e=>console.error(e));
